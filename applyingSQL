#1 Aggregating Finances: 
Difference of active/Non-active Users
The following query will return two records grouped by active status, 'false' or 'true'. The selected fields are active status, number of transactions in each active status, the average amount spent in each active status, and the total amount spend by active status.

SELECT
  active,
  COUNT(payment_id) AS num_transactions,
  AVG(amount) AS avg_amount,
  SUM(amount) AS total_amount
FROM payment AS p
INNER JOIN customer AS c
ON p.customer_id = c.customer_id
GROUP BY active;



#2 Aggregating Strings: 
Demonstrate family-friendly/multi-lingual films
The query below will return a column with a list of all the different languages following by a column including all the film titles that are available in that language. This query demonstrates only films released in 2010 with a 'G' rating by combining two tables on the primary key 'language_id'.
SELECT
  name,
  STRING_AGG(title, ',') AS film_titles
FROM film AS f
INNER JOIN language AS l
  ON f.language_id = l.language_id
WHERE release_year = 2010
  AND rating = 'G'
GROUP BY name;



#3 Navigating Database
A database can have hundreds of tables and individually selecting all columns from each table would be an inefficient way to scrub through the tables for the right data to answer a business question. An efficient way is to query the list of tables by querying a specific system table such as Postgres or Oracle. This returns schema name, table name, and table owner such as Postgres
SELECT *
FROM pg_catalog.pg_tables
WHERE schemaname = 'public';

# SQL Server - TSQL
SELECT *
FROM INFORMATION_SCHEMA.TABLES;

# MySQL
SHOW TABLES;

#4 VIEW columns from tables
CREATE VIEW table_columns AS 
SELECT 
  table_name,
  STRING_AGG(column_name, ', ') AS columns
FROM information_schema.columns
WHERE table_schema = 'public'
GROUP BY table_name;
SELECT *
FROM table_columns



#5 Aggregate Film Lenths
The query returns a report of the average length of films grouped by categories, joined by two tables on a unique identifier for the films.
SELECT category,
  AVG(length) AS average_length
FROM film AS f
INNER JOIN category AS c
ON f.film_id = c.film_id
GROUP BY category
ORDER BY average_length;




#6 Aggregate Film Rentals
Returning number of rentals in each city to identify business opportunities for the best customer contrasting the potential detractors.
Join the 'rental' table and 'address' table for city information
Problem: There is no common key between these tables so we use the 'customer' table because it has a field in 'rental' and address'. Visually connected the three tables is a process called 



